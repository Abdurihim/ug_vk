// ug_vk.js (https://github.com/finalfantasia/ug_vk)
// The MIT License (MIT)
// Copyright (c) 2013, 2014 Abdussalam Abdurrahman (abdusalam.abdurahman@gmail.com)
!function(t){"use strict"
function e(t){return"function"==typeof t}function n(t){return"[object Array]"===Object.prototype.toString.call(t)}function a(t,e){var n
for(n=0;n<t.length;n++)if(t[n]===e)return n
return-1}function i(){L={a:"ھ",b:"ب",c:"غ",D:"ژ",d:"د",e:"ې",F:"ف",f:"ا",G:"گ",g:"ە",H:"خ",h:"ى",i:"ڭ",J:"ج",j:"ق",K:"ۆ",k:"ك",l:"ل",m:"م",n:"ن",o:"و",p:"پ",q:"چ",r:"ر",s:"س",t:"ت",u:"ۇ",v:"ۈ",w:"ۋ",x:"ش",y:"ي",z:"ز","/":"ئ",";":"؛","?":"؟",",":"،",_:"—","(":")",")":"(","[":"]","]":"[","{":"»","}":"«","<":"›",">":"‹"},C=[L.f,L.g,L.e,L.h,L.o,L.u,L.K,L.v],K=L["/"],_=[L[";"],L["?"],L[","]],S={},S.K=r,S.T=o,S.Y=o,G=!0}function r(t){var e
for(M[t.name]="ug"===M[t.name]?"en":"ug",e=0;e<A.length;e++)A[e]({target:t,keyboardMode:M[t.name]})}function o(t){t.dir="ltr"===t.dir?"rtl":"ltr"}function l(t){var e=t.charCodeAt(0)
return e>=D&&T>e&&a(_,t)<0}function c(t){return l(t)&&a(C,t)>=0}function u(t,e){var n,a=e,i=t.selectionStart
return c(e)&&(0===i?a=K+e:(n=t.value[i-1],(!l(n)||c(n))&&(a=K+e))),a}function s(t,e){var n,a
"selection"in H&&"createRange"in H.selection?H.selection.createRange().text=e:(z.smartHamza&&(e=u(t,e)),n=t.selectionStart,t.value=t.value.slice(0,t.selectionStart)+e+t.value.slice(t.selectionEnd),a=n+e.length,t.setSelectionRange(a,a))}function d(t,e,n){"addEventListener"in t?(t.removeEventListener(e,n,!1),t.addEventListener(e,n,!1)):(t.detachEvent("on"+e,n),t.attachEvent("on"+e,n))}function h(t,e,n){"removeEventListener"in t?t.removeEventListener(e,n,!1):t.detachEvent("on"+e,n)}function f(t,e){function n(){h(t,"touchmove",a),h(t,"touchend",i),o=null,l=null,c=null,u=null}function a(t){var e
t.touches.length>1?n():(c=t.touches[0].pageX-o,e=t.touches[0].pageY-l,u&&0>u&&c>0||u>0&&0>c||Math.abs(e)>f?n():(u=c,t.preventDefault()))}function i(){var a=Math.abs(c)
n(),a>s&&e({target:t,direction:c>0?"RIGHT":"LEFT"})}function r(e){1===e.touches.length&&(o=e.touches[0].pageX,l=e.touches[0].pageY,d(t,"touchmove",a),d(t,"touchend",i))}var o,l,c,u,s=50,f=15
d(t,"touchstart",r)}function v(t){var e=t.target||t.srcElement,n="which"in t?t.which:t.keyCode,a=String.fromCharCode(n).toUpperCase(),i=t.ctrlKey||t.metaKey
i&&a in S&&(S[a](e),"preventDefault"in t?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!0))}function g(e){var n,a="target"in e?e.target:e.srcElement,i="which"in e?e.which:e.keyCode,r=String.fromCharCode(i),o=/^[A-Za-z]{1}$/.test(r),l=e.ctrlKey||e.metaKey,c=!1
l||"ug"!==M[a.name]||(r in L?("keyCode"in e&&!("which"in e)?e.keyCode=L[r].charCodeAt(0):s(a,L[r]),c=!0):o&&(c=!0,e.returnValue=!1)),c&&("preventDefault"in e?(e.preventDefault(),e.stopPropagation()):e.cancelBubble=!0,n=new t.Event("input",{bubbles:!0}),a.dispatchEvent(n))}function m(){var t,e,n,a=[]
for(t=H.getElementsByTagName("input"),e=H.getElementsByTagName("textarea"),n=0;n<t.length;n++)"text"===t[n].type.toLowerCase()&&a.push(t[n])
for(n=0;n<e.length;n++)a.push(e[n])
return a}function p(){var t,e,n
if(t=m(),z.all)for(n=0;n<t.length;n++)e=t[n],a(z.blacklist,e.name)<0&&(d(e,"keydown",v),d(e,"keypress",g),f(e,r),M[e.name]="ug")
else for(n=0;n<t.length;n++)e=t[n],a(z.whitelist,e.name)>=0&&(d(e,"keydown",v),d(e,"keypress",g),f(e,r),M[e.name]="ug")}function y(){var t,e,n
for(t=m(),n=0;n<t.length;n++)e=t[n],h(e,"keydown",v),h(e,"keypress",g)}function b(){var e={}
return e.all=!!t.attachAll,e.all?e.blacklist="string"==typeof t.bedit_deny&&t.bedit_deny.length>0?t.bedit_deny.split(":"):[]:e.whitelist="string"==typeof t.bedit_allow&&t.bedit_allow.length>0?t.bedit_allow.split(":"):[],e}function w(t){var e
return t.smartHamza=!("smartHamza"in t&&!t.smartHamza),t.all=!!t.all,t.all?"blacklist"in t?e=n(t.blacklist):(t.blacklist=[],e=!0):e=n(t.whitelist)&&t.whitelist.length>0,e}function E(){var r={}
G||(r="object"==typeof t.UG_VK_OPTS?t.UG_VK_OPTS:b(),w(r)&&(z=r,i(),p()),t.UG_VK={addInputEventListeners:function(t){t&&(z={all:"all"in t?!!t.all:z.all,whitelist:n(t.whitelist)?t.whitelist:z.whitelist,blacklist:n(t.blacklist)?t.blacklist:z.blacklist,smartHamza:"smartHamza"in t?!!t.smartHamza:z.smartHamza}),G||i(),y(),p()},addKeyboardModeChangeListener:function(t){G&&e(t)&&a(A,t)<0&&A.push(t)}})}function k(e){function n(){o||(o=!0,e())}function a(){"removeEventListener"in H&&H.removeEventListener("DOMContentLoaded",a,!1),n()}function i(){if(!o){try{H.body.doScroll("up")}catch(t){return void setTimeout(i,50)}n()}}function r(){return"attachEvent"in H||"loading"===H.readyState?void(l||(l=!0,"addEventListener"in H?(H.addEventListener("DOMContentLoaded",a,!1),t.addEventListener("load",a,!1)):(H.attachEvent("onload",a),i()))):void n()}var o=!1,l=!1
r()}var L,C,_,K,S,z,H=t.document,D=1536,T=1791,M={},A=[],G=!1
k(E)}(window)
